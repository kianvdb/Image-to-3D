<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Dog Assets bewerken</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="manageAssets.css" />
</head>
<body>
    <div class="adminNav">
        <a href="homepage.html">
            <img src="/frontend/public/logo2dalma.png" alt="DALMA AI">
        </a>
        <a href="homepage.html">
            Terug naar homepage <i class="fas fa-long-arrow-right"></i>
        </a>
    </div>

    <div class="container">
        <h2>3D Dog Assets aanmaken of bewerken</h2>
        <form id="assetForm" enctype="multipart/form-data">
            <div class="form-row">
                <div class="form-group">
                    <label for="name">Asset Naam</label>
                    <input type="text" id="name" name="name" required placeholder="bv. Golden Retriever">
                </div>
                <div class="form-group">
                    <label for="breed">Hondenras</label>
                    <input type="text" id="breed" name="breed" required placeholder="bv. Golden Retriever">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="icon">Icon/Emoji</label>
                    <input type="text" id="icon" name="icon" required placeholder="ðŸ•" maxlength="2">
                </div>
                <div class="form-group">
                    <label for="fileSize">Bestandsgrootte</label>
                    <input type="text" id="fileSize" name="fileSize" required placeholder="bv. 2.5 MB">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="polygons">Aantal Polygonen</label>
                    <input type="number" id="polygons" name="polygons" required placeholder="15000">
                </div>
                <div class="form-group">
                    <label for="popularity">Populariteit (0-100)</label>
                    <input type="number" max="100" min="0" id="popularity" name="popularity" required placeholder="85">
                </div>
            </div>

            <div class="form-group">
                <label for="tags">Tags (gescheiden door komma's)</label>
                <input type="text" id="tags" name="tags" required placeholder="realistic, textured, animated">
            </div>

            <div class="form-group">
                <label for="description">Beschrijving</label>
                <textarea id="description" name="description" required placeholder="Beschrijf het 3D model..."></textarea>
            </div>

            <div class="form-group">
                <label for="modelFile">3D Model Bestand (.glb, .gltf)</label>
                <div class="file-upload-area">
                    <input type="file" id="modelFile" name="modelFile" accept=".glb,.gltf" required>
                    <p>Sleep het 3D model bestand hierheen of klik om te uploaden</p>
                </div>
            </div>

            <div class="form-group">
                <label for="previewImage">Preview Afbeelding</label>
                <div class="file-upload-area">
                    <input type="file" id="previewImage" name="previewImage" accept="image/*">
                    <p>Optioneel: Upload een preview afbeelding</p>
                </div>
            </div>

            <button type="submit">Maak het asset aan</button>
        </form>
        <div id="message" class="message" style="display: none;"></div>
    </div>

    <div class="container asset-side" id="assetContainer">
        <!-- Assets will be loaded here -->
    </div>

    <script>
        let editingAssetId = null;
        let assetsData = [];

        // Sample data for demonstration
        const sampleAssets = [
            {
                _id: '1',
                name: 'Labrador Retriever',
                breed: 'Labrador Retriever',
                icon: 'ðŸ•',
                fileSize: '2.3 MB',
                polygons: 12500,
                tags: ['friendly', 'realistic', 'textured'],
                description: 'High-quality Labrador model with realistic textures and animations',
                popularity: 95,
                dateAdded: '2024-01-15',
                modelFile: 'labrador.glb',
                previewImage: null
            },
            {
                _id: '2',
                name: 'German Shepherd',
                breed: 'German Shepherd',
                icon: 'ðŸº',
                fileSize: '3.1 MB',
                polygons: 18000,
                tags: ['guard', 'detailed', 'animated'],
                description: 'Detailed German Shepherd with guard animations and realistic fur',
                popularity: 88,
                dateAdded: '2024-01-10',
                modelFile: 'german_shepherd.glb',
                previewImage: null
            },
            {
                _id: '3',
                name: 'Beagle',
                breed: 'Beagle',
                icon: 'ðŸ¶',
                fileSize: '1.8 MB',
                polygons: 9500,
                tags: ['small', 'cute', 'low-poly'],
                description: 'Adorable Beagle perfect for mobile applications and games',
                popularity: 92,
                dateAdded: '2024-01-20',
                modelFile: 'beagle.glb',
                previewImage: null
            },
            {
                _id: '4',
                name: 'English Bulldog',
                breed: 'English Bulldog',
                icon: 'ðŸ•â€ðŸ¦º',
                fileSize: '2.7 MB',
                polygons: 14200,
                tags: ['sturdy', 'character', 'textured'],
                description: 'Characterful Bulldog with detailed facial features and expressions',
                popularity: 76,
                dateAdded: '2024-01-05',
                modelFile: 'bulldog.glb',
                previewImage: null
            }
        ];

        async function fetchAssets() {
            try {
                // In a real application, this would fetch from your API
                // const response = await fetch('https://your-api.com/api/assets');
                // const assets = await response.json();
                
                // For now, use sample data
                const assets = sampleAssets;
                assetsData = assets;
                
                const assetContainer = document.getElementById('assetContainer');
                assetContainer.innerHTML = '';
                
                assets.forEach(asset => {
                    const assetElement = document.createElement('div');
                    assetElement.classList.add('asset-item');
                    
                    assetElement.innerHTML = `
                        <div class="asset-preview">
                            ${asset.icon}
                        </div>
                        <div class="asset-info">
                            <h3>${asset.name}</h3>
                            <p><strong>Ras:</strong> ${asset.breed}</p>
                            <p><strong>Bestandsgrootte:</strong> ${asset.fileSize}</p>
                            <p><strong>Polygonen:</strong> ${asset.polygons.toLocaleString()}</p>
                            <p><strong>Populariteit:</strong> ${asset.popularity}%</p>
                            <p><strong>Beschrijving:</strong> ${asset.description}</p>
                            <div class="asset-tags">
                                ${asset.tags.map(tag => `<span class="asset-tag">${tag}</span>`).join('')}
                            </div>
                            <div class="asset-buttons">
                                <button class="edit-asset" data-id="${asset._id}">Bewerk</button>
                                <button class="delete-asset" data-id="${asset._id}">Verwijder</button>
                            </div>
                        </div>
                    `;
                    assetContainer.appendChild(assetElement);
                });
            } catch (error) {
                console.error('Error fetching assets:', error);
                showMessage('Fout bij het laden van assets: ' + error.message, 'error');
            }
        }

        function showMessage(text, type = 'success') {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.style.display = 'block';
            
            if (type === 'error') {
                messageDiv.style.background = 'rgba(220, 53, 69, 0.1)';
                messageDiv.style.color = '#dc3545';
                messageDiv.style.borderColor = 'rgba(220, 53, 69, 0.3)';
            } else {
                messageDiv.style.background = 'rgba(0, 188, 212, 0.1)';
                messageDiv.style.color = '#00bcd4';
                messageDiv.style.borderColor = 'rgba(0, 188, 212, 0.3)';
            }

            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        function resetForm() {
            document.getElementById('assetForm').reset();
            editingAssetId = null;
            document.querySelector('button[type="submit"]').textContent = 'Maak het asset aan';
        }

        document.addEventListener('DOMContentLoaded', () => {
            const assetForm = document.getElementById('assetForm');

            assetForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                const formData = new FormData(assetForm);
                
                // Convert form data to object
                const assetData = {
                    name: formData.get('name'),
                    breed: formData.get('breed'),
                    icon: formData.get('icon'),
                    fileSize: formData.get('fileSize'),
                    polygons: parseInt(formData.get('polygons')),
                    popularity: parseInt(formData.get('popularity')),
                    tags: formData.get('tags').split(',').map(tag => tag.trim()),
                    description: formData.get('description'),
                    modelFile: formData.get('modelFile').name,
                    previewImage: formData.get('previewImage').name || null,
                    dateAdded: new Date().toISOString().split('T')[0]
                };

                try {
                    if (editingAssetId) {
                        // Update existing asset
                        const assetIndex = assetsData.findIndex(a => a._id === editingAssetId);
                        if (assetIndex !== -1) {
                            assetsData[assetIndex] = { ...assetsData[assetIndex], ...assetData };
                            showMessage('Asset succesvol bijgewerkt!');
                        }
                    } else {
                        // Create new asset
                        const newAsset = {
                            _id: Date.now().toString(),
                            ...assetData
                        };
                        assetsData.push(newAsset);
                        showMessage('Asset succesvol aangemaakt!');
                    }

                    resetForm();
                    fetchAssets();
                } catch (error) {
                    showMessage('Fout bij het opslaan: ' + error.message, 'error');
                }
            });

            // Handle edit and delete buttons
            document.getElementById('assetContainer').addEventListener('click', async (event) => {
                if (event.target.classList.contains('edit-asset')) {
                    const assetId = event.target.dataset.id;
                    const asset = assetsData.find(a => a._id === assetId);
                    
                    if (asset) {
                        window.scrollTo(0, 0);

                        document.getElementById('name').value = asset.name;
                        document.getElementById('breed').value = asset.breed;
                        document.getElementById('icon').value = asset.icon;
                        document.getElementById('fileSize').value = asset.fileSize;
                        document.getElementById('polygons').value = asset.polygons;
                        document.getElementById('popularity').value = asset.popularity;
                        document.getElementById('tags').value = asset.tags.join(', ');
                        document.getElementById('description').value = asset.description;

                        editingAssetId = assetId;
                        document.querySelector('button[type="submit"]').textContent = 'Werk het asset bij';
                    }
                } else if (event.target.classList.contains('delete-asset')) {
                    const assetId = event.target.dataset.id;
                    
                    if (confirm('Weet je zeker dat je dit asset wilt verwijderen?')) {
                        const assetIndex = assetsData.findIndex(a => a._id === assetId);
                        if (assetIndex !== -1) {
                            assetsData.splice(assetIndex, 1);
                            showMessage('Asset succesvol verwijderd!');
                            fetchAssets();
                        }
                    }
                }
            });

            fetchAssets();
        });
    </script>
</body>
</html>